"chromosome_name",
"start_position",
"end_position",
"strand",
"gene_biotype",
"description")
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) %>%
fix_genes
fix_genes <- . %>%
tbl_df %>%
distinct %>%
rename(ensgene=ensembl_gene_id,
entrez=entrezgene,
symbol=external_gene_name,
chr=chromosome_name,
start=start_position,
end=end_position,
biotype=gene_biotype)
myattributes <- c("ensembl_gene_id",
"entrezgene",
"external_gene_name",
"chromosome_name",
"start_position",
"end_position",
"strand",
"gene_biotype",
"description")
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) %>%
fix_genes
library(biomaRt)
library(dplyr)
fix_genes <- . %>%
tbl_df %>%
distinct %>%
rename(ensgene=ensembl_gene_id,
entrez=entrezgene,
symbol=external_gene_name,
chr=chromosome_name,
start=start_position,
end=end_position,
biotype=gene_biotype)
myattributes <- c("ensembl_gene_id",
"entrezgene",
"external_gene_name",
"chromosome_name",
"start_position",
"end_position",
"strand",
"gene_biotype",
"description")
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) %>%
fix_genes
grch38
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes)
grch38
View(grch38)
columns(org.Hs.eg.db)
acc.ncv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
gene.name<- acc.ncv$Gene.Symbol
class(gene)
class(gene.name)
library(tidyr)
library(dplyr)
head(mtcars)
rownames(mtcars)
colnames(mtcars)
mtcars$car <- rownames(mtcars)
head(mtcars)
mtcars<- mtcars[,c(12,1:11)]
head(mtcars)
glimpse(mtcars)
mtcarsNew<- mtcars %>% gather(attribute, value, -car)
head(mtcarsNew)
tail(mtcarsNew)
View(mtcarsNew)
mtcarsNew<- mtcars %>%
gather(attribute, value, mpg:gear)
head(mtcarsNew)
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv
dim(acc.cnv)
columns(org.Hs.eg.db)
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "|")
acc.cnv[198:240, 1:4]
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "|")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv$Gene.Symbol
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "|")
acc.cnv[198:240, 1:4]
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "|")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "\|")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "/|")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "$|")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv<- acc.cnv %>%
separate(Gene.Symbol, c("Gene.Symbol", "ENSG"), sep = "\\||")
acc.cnv[198:240, 1:4]
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
acc.cnv[198:240, 1:4]
test<-acc.cnv[238, 1]
test
strsplit(test,split='\\|and')
strsplit(test,split='\\|')
sub(test, pattern="\\|", replacement=" ")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
test<-acc.cnv[238, 1]
test
gsub("\\.|*","",test)
gsub("\\|.*","",test)
gene.name<- acc.ncv$Gene.Symbol
gene.name<- acc.ncv$Gene.Symbol
gene.name<- gsub("\\|.*","",gene.name)
gene.name<- acc.ncv$Gene.Symbol
gene.name[198:240]
gene.name<- gsub("\\|.*","",gene.name)
gene.name[198:240]
select(org.Hs.eg.db, keys = gene.name, columns = c("ENTREZID"), keytype = "SYMBOL")
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
columns(org.Hs.eg.db)
gene.name<- acc.ncv$Gene.Symbol
gene.name[198:240]
gene.name<- gsub("\\|.*","",gene.name)
gene.name[198:240]
new.entrez.id<- select(org.Hs.eg.db, keys = gene.name, columns = c("ENTREZID"), keytype = "SYMBOL")
gene.name<- acc.ncv$Gene.Symbol
gene.name[198:240]
gene.name<- gsub("\\|.*","",gene.name)
gene.name[198:240]
new.entrez.id<- select(org.Hs.eg.db, keys = gene.name, columns = c("ENTREZID"), keytype = "SYMBOL")
new.entrez.id
dim(acc.cnv)
length(new.entrez.id)
nrow(new.entrez.id)
columns(org.Hs.eg.db)
ls("package:org.Hs.eg.db")
columns(org.Hs.eg.db, org.Hs.egCHRLOC)
columns(org.Hs.egCHRLOC)
keys<- keys(org.Hs.eg.db, keytype = "ENSEMBL")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENSEMBL")
sel2<- sel[sel$ENSEMBL %in% rownames(sig),]
sig<- c("ENSG00000099622", "ENSG00000114737", "ENSG00000105254", "ENSG00000104879", "ENSG00000237289")
sel2<- sel[sel$ENSEMBL %in% rownames(sig),]
sel2
View(sel)
View(sel2)
sel2<- sel[sel$ENSEMBL %in% sig,]
View(sel2)
sel3<- na.omit(sel2[!duplicated(sel$ENSEMBL)])
sel3<- na.omit(sel2[!duplicated(sel$ENSEMBL), ])
sel3
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3<- na.omit(sel2[!duplicated(sel2$ENSEMBL), ])
sel3
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
sel3
sel2
gene.name<- acc.ncv$Gene.Symbol
gene.name[198:240]
gene.name<- gsub("\\|.*","",gene.name)
gene.name[198:240]
new.entrez.id<- select(org.Hs.eg.db, keys = gene.name, columns = c("ENTREZID"), keytype = "SYMBOL")
new.entrez.id
nrow(new.entrez.id)
keytype(org.Hs.eg.db)
keytypes(org.Hs.eg.db)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
dim(sel)
acc.locus.id<- acc.cnv$Locus.ID
dim(acc.locus.id)
acc.locus.id
length(acc.locus.id)
acc.locus.id<- acc.cnv$Locus.ID
length(acc.locus.id)
sel2<- sel[sel$ENSEMBL %in% acc.locus.id,]
sel2
sel2<- sel[sel$ENTREZID %in% acc.locus.id,]
sel2
dim(sel2)
sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
sel3
dim(sel3)
dim(sel2)
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
head(sel3)
dim(sel)
dim(sel3)
new.keys<- new.entrez.id
new.keys
new.keys<- new.entrez.id$ENTREZID
new.keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
dim(sel)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
length(new.entrez.id)
new.acc.locus.id<- new.entrez.id$ENTREZID
length(new.entrez.id)
length(new.acc.locus.id)
new.acc.locus.id<- new.entrez.id$ENTREZID
length(new.acc.locus.id)
new.sel2<- sel[sel$ENTREZID %in% new.acc.locus.id,]
new.sel2
dim(new.sel2)
new.sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
new.sel3
dim(new.sel3)
dim(sel3)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
dim(sel)
new.acc.locus.id<- new.entrez.id$ENTREZID
length(new.acc.locus.id)
new.sel2<- sel[sel$ENTREZID %in% new.acc.locus.id,]
new.sel2
dim(new.sel2)
new.sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
new.sel3
dim(new.sel3)
dim(sel3)
new.sel3$strand<- ifelse(new.sel3$CHRLOC <0, "-", "+")
new.sel3
new.sel3$start<- abs(new.sel3$CHRLOC)
new.sel3$end<- abs(new.sel3$CHRLOCEND)
head(new.sel3)
dim(new.sel3)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
dim(sel)
acc.locus.id<- acc.cnv$Locus.ID
length(acc.locus.id)
sel2<- sel[sel$ENTREZID %in% acc.locus.id,]
sel2
dim(sel2)
sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
sel3
dim(sel3)
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
head(sel3)
dim(sel3)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
dim(sel)
new.acc.locus.id<- new.entrez.id$ENTREZID
length(new.acc.locus.id)
new.sel2<- sel[sel$ENTREZID %in% new.acc.locus.id,]
new.sel2
dim(new.sel2)
new.sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
new.sel3
dim(new.sel3)
dim(sel3)
new.sel3$strand<- ifelse(new.sel3$CHRLOC <0, "-", "+")
new.sel3
new.sel3$start<- abs(new.sel3$CHRLOC)
new.sel3$end<- abs(new.sel3$CHRLOCEND)
head(new.sel3)
dim(new.sel3)
acc.ncv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = FALSE)
dim(acc.ncv)
class(acc.ncv)
View(acc.ncv)
acc.ncv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
dim(acc.ncv)
class(acc.ncv)
View(acc.ncv)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
acc.locus.id<- acc.cnv$Locus.ID
acc.cnv<- read.delim("/Users/Matt/Documents/Masters_Bioinformatics/Internships/Data/unzipped data/ACC/all_data_by_genes.txt", stringsAsFactors = FALSE, header = TRUE)
dim(acc.cnv)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
dim(sel)
acc.locus.id<- acc.cnv$Locus.ID
length(acc.locus.id)
sel2<- sel[sel$ENTREZID %in% acc.locus.id,]
sel2
dim(sel2)
sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
sel3
dim(sel3)
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
head(sel3)
dim(sel3)
head(acc.cnv)
colnames(sel3$ENTREZID)<- "Locus.ID"
?dplyr::rename
rename(sel3, Locus.ID = ENTREZID)
rename(sel3, "Locus.ID" = "ENTREZID")
head(sel3)
rename(sel3, Locus.ID = ENTREZID)
dplyr::rename(sel3, Locus.ID = ENTREZID)
dplyr::rename(sel3, Locus.ID = ENTREZID) %>% head()
sel3<- dplyr::rename(sel3, Locus.ID = ENTREZID)
acc.cnv.loc<- full_join(sel3,acc.cnv, by=Locus.ID)
?dplyr::full_join
acc.cnv.loc<- full_join(sel3,acc.cnv, by=Locus.ID)
acc.cnv.loc<- full_join(sel3,acc.cnv, by="Locus.ID")
class(acc.cnv$Locus.ID)
class(sel3$Locus.ID)
sel3$Locus.ID<- as.integer(sel3$Locus.ID)
class(sel3$Locus.ID)
acc.cnv.loc<- full_join(sel3,acc.cnv, by="Locus.ID")
head(acc.cnv.loc)
acc.cnv.loc<- full_join(acc.cnv, sel3, by="Locus.ID")
acc.cnv.loc<- full_join(acc.cnv, sel3, by="Locus.ID")
head(acc.cnv.loc)
dplyr::arrange(acc.cnv.loc, CHR, start)
acc.cnv.loc<- dplyr::arrange(acc.cnv.loc, CHR, start)
View(acc.cnv.loc)
class(acc.cnv.loc$CHR)
class(acc.cnv.loc$start)
class(acc.cnv.loc$CHR)
acc.cnv.loc<- full_join(acc.cnv, sel3, by="Locus.ID")
head(acc.cnv.loc)
class(acc.cnv.loc$CHR)
acc.cnv.loc$CHR<- as.integer(acc.cnv.loc$CHR)
sel2<- sel[sel$ENTREZID %in% acc.locus.id,]
sel2
dim(sel2)
sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
sel3
dim(sel3)
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
head(sel3)
dim(sel3)
head(acc.cnv)
?dplyr::rename
sel3<- dplyr::rename(sel3, Locus.ID = ENTREZID)
?dplyr::full_join
class(acc.cnv$Locus.ID)
class(sel3$Locus.ID)
sel3$Locus.ID<- as.integer(sel3$Locus.ID)
class(sel3$Locus.ID)
acc.cnv.loc<- full_join(acc.cnv, sel3, by="Locus.ID")
head(acc.cnv.loc)
class(acc.cnv.loc$CHR)
acc.cnv.loc$CHR<- as.integer(acc.cnv.loc$CHR)
is.na(acc.cnv.loc$CHR)
View(acc.cnv)
sel2<- sel[sel$ENTREZID %in% acc.locus.id,]
sel2
dim(sel2)
sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
sel3
dim(sel3)
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
head(sel3)
dim(sel3)
sel3<- dplyr::rename(sel3, Locus.ID = ENTREZID)
sel3$Locus.ID<- as.integer(sel3$Locus.ID)
acc.cnv.loc<- full_join(acc.cnv, sel3, by="Locus.ID")
View(acc.cnv.loc)
head(acc.cnv.loc)
class(acc.cnv.loc$CHR)
acc.cnv.loc$CHR<- as.integer(acc.cnv.loc$CHR)
is.na(acc.cnv.loc$CHR)
?is.na
is.na()
is.na(acc.cnv.loc)
is.na(acc.cnv.loc, arr.ind = TRUE)
which(is.na(acc.cnv.loc), arr.ind = TRUE)
is.na(acc.cnv.loc$CHR)
which(is.na(acc.cnv.loc))
which(is.na(acc.cnv.loc), arr.ind = TRUE)
which(is.na(acc.cnv.loc))
which( !is.na(acc.cnv.loc), arr.ind=TRUE)
which(is.na(acc.cnv.loc), arr.ind=TRUE)
dim(acc.cnv.loc)
keys<- keys(org.Hs.eg.db, keytype = "ENTREZID")
keys
columns<- c("CHR", "CHRLOC", "CHRLOCEND")
sel<- select(org.Hs.eg.db, keys, columns, keytype = "ENTREZID")
View(sel)
dim(sel)
acc.locus.id<- acc.cnv$Locus.ID
length(acc.locus.id)
sel2<- sel[sel$ENTREZID %in% acc.locus.id,]
sel2
dim(sel2)
sel3<- na.omit(sel2[!duplicated(sel2$ENTREZID), ])
sel3
dim(sel3)
sel3$strand<- ifelse(sel3$CHRLOC <0, "-", "+")
sel3
sel3$start<- abs(sel3$CHRLOC)
sel3$end<- abs(sel3$CHRLOCEND)
head(sel3)
dim(sel3)
head(acc.cnv)
?dplyr::rename
sel3<- dplyr::rename(sel3, Locus.ID = ENTREZID)
?dplyr::full_join
class(acc.cnv$Locus.ID)
class(sel3$Locus.ID)
sel3$Locus.ID<- as.integer(sel3$Locus.ID)
class(sel3$Locus.ID)
acc.cnv.loc<- full_join(acc.cnv, sel3, by="Locus.ID")
head(acc.cnv.loc)
class(acc.cnv.loc$CHR)
acc.cnv.loc$CHR<- as.integer(acc.cnv.loc$CHR)
is.na(acc.cnv.loc$CHR)
which(is.na(acc.cnv.loc), arr.ind = TRUE)
dim(acc.cnv.loc)
acc.cnv.loc<- dplyr::arrange(acc.cnv.loc, CHR, start)
View(acc.cnv.loc)
View(acc.cnv)
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) #%>%
myattributes <- c("ensembl_gene_id",
"entrezgene",
"external_gene_name",
"chromosome_name",
"start_position",
"end_position",
"strand",
"gene_biotype",
"description")
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) #%>%
library(biomaRt)
library(dplyr)
fix_genes <- . %>%
tbl_df %>%
distinct %>%
rename(ensgene=ensembl_gene_id,
entrez=entrezgene,
symbol=external_gene_name,
chr=chromosome_name,
start=start_position,
end=end_position,
biotype=gene_biotype)
myattributes <- c("ensembl_gene_id",
"entrezgene",
"external_gene_name",
"chromosome_name",
"start_position",
"end_position",
"strand",
"gene_biotype",
"description")
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) #%>%
grch38 <- useMart("ensembl") %>%
useDataset(mart=., dataset="hsapiens_gene_ensembl") %>%
getBM(mart=., attributes=myattributes) #%>%
