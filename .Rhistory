codeletion_per_target_gene<- as.data.frame(cbind(Gene.Symbol.row = rownames(codeletion_matrix), codeletion_matrix))
codeletion_per_target_gene[1:10, 1:10]
cbind(1:1000000, 1:1000000, 1:1000000, 1:1000000, 1:1000000)
codeletion_per_target_gene[1:10, 1:10]
gathered<- tidyr::gather(codeletion_matrix, Gene.Symbol.col,proportion, 2:ncol(codeletion_matrix))
gathered<- tidyr::gather(codeletion_per_target_gene, Gene.Symbol.col,proportion, 2:ncol(codeletion_matrix))
head(gathered)
rownames(codeletion_matrix)
grep(IL9R|ENSG00000124334.12,rownames(codeletion_matrix))
grep("IL9R|ENSG00000124334.12",rownames(codeletion_matrix))
ncol(codeletion_matrix)
gathered<- tidyr::gather(codeletion_per_target_gene, Gene.Symbol.col,proportion, 2:ncol(codeletion_matrix))
head(gathered)
library(VennDiagram)
install.packages('VennDiagram')
library(VennDiagram)
d <- read.csv("catdoge.csv")
.libPaths(VennDiagram)
.Library
library("gdata")
geneLists <- read.xls("randomGeneLists.xlsx", sheet=1, stringsAsFactors=FALSE, header=FALSE)
install.packages("VennDiagram")
install.packages("VennDiagram")
require("VennDiagram")
gId_ctrl_24h_filt<- ("a", "b", "c", "d")
gId_ctrl_4d_filt<- ("b", "c", "d", "e", "g")
gId_24_4d_filt<- ("a", "b", "f")
gId_ctrl_24h_filt<- c("a", "b", "c", "d")
gId_ctrl_4d_filt<- c("b", "c", "d", "e", "g")
gId_24_4d_filt<- c("a", "b", "f")
gId_ctrl_24h_filt<- c("a", "b", "c", "d")
gId_ctrl_4d_filt<- c("b", "c", "d", "e", "g")
gId_24_4d_filt<- c("a", "b", "f")
switch.gene.comparison<-list(gId_ctrl_24h_filt,
gId_ctrl_4d_filt,
gId_24_4d_filt
)
names(switch.gene.comparison) <- c("ctrl_24h", "ctrl_4d", "24_4d")
VENN.LIST <- switch.gene.comparison
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_"
main="Genes with differential splicing between conditions")
switch.gene.comparison
10
ï¿¼grid.draw(venn.plot)
#Get genes with differential splicing:
a <- venn(VENN.LIST, show.plot=FALSE)
str(a)
inters <- attr(a,"intersections")
inters
lapply(inters, head)
# genes in all three: "ENSMUSG00000018012" "ENSMUSG00000023904" "ENSMUSG00000048583"
########
#venn diagram for Genes with 2 fold transcript dominance:
list1<-c("ENSMUSG00000022297" ,"ENSMUSG00000036106", "ENSMUSG00000042505",
"ENSMUSG00000050428")
list2<-c("ENSMUSG00000036106" ,"ENSMUSG00000068101")
list3<-c("ENSMUSG00000022297" ,"ENSMUSG00000023330", "ENSMUSG00000068101",
"ENSMUSG00000074519")
switch.gene.comparison<-list(list1,list2 ,list3)
switch.gene.comparison
names(switch.gene.comparison) <- c("ctrl_24h", "ctrl_4d", "24_4d")
VENN.LIST <- switch.gene.comparison
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
VENN.LIST <- switch.gene.comparison
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_"
main="Genes with differential splicing between conditions"))
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions"))
?venn.diagram
venn.plot <- venn.diagram(
x = list(
A = c(1:10),
B = c(11:90),
C = c(81:90)
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0
)
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g",
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g",
C = c("a", "b", "f")
)
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g",
C = c("a", "b", "f")
)
venn.plot <- venn.diagram(
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g"),
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0
)
venn.plot <- venn.diagram(
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g"),
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
)
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_"
main="Genes with differential splicing between conditions")
gId_ctrl_24h_filt<- c("a", "b", "c", "d")
gId_ctrl_4d_filt<- c("b", "c", "d", "e", "g")
gId_24_4d_filt<- c("a", "b", "f")
switch.gene.comparison<-list(gId_ctrl_24h_filt,
gId_ctrl_4d_filt,
gId_24_4d_filt
)
names(switch.gene.comparison) <- c("ctrl_24h", "ctrl_4d", "24_4d")
VENN.LIST <- switch.gene.comparison
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions"))
venn.plot <- venn.diagram(
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g"),
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
)
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_"
main="Genes with differential splicing between conditions")
gId_ctrl_24h_filt<- c("a", "b", "c", "d")
gId_ctrl_4d_filt<- c("b", "c", "d", "e", "g")
gId_24_4d_filt<- c("a", "b", "f")
switch.gene.comparison<-list(gId_ctrl_24h_filt,
gId_ctrl_4d_filt,
gId_24_4d_filt
)
names(switch.gene.comparison) <- c("ctrl_24h", "ctrl_4d", "24_4d")
VENN.LIST <- switch.gene.comparison
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions"))
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g"),
gene3 = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
)
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_"
main="Genes with differential splicing between conditions")
gId_ctrl_24h_filt<- c("a", "b", "c", "d")
gId_ctrl_4d_filt<- c("b", "c", "d", "e", "g")
gId_24_4d_filt<- c("a", "b", "f")
switch.gene.comparison<-list(gId_ctrl_24h_filt,
gId_ctrl_4d_filt,
gId_24_4d_filt
)
names(switch.gene.comparison) <- c("ctrl_24h", "ctrl_4d", "24_4d")
VENN.LIST <- switch.gene.comparison
venn.plot <- venn.diagram(VENN.LIST , NULL, fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cex = 2, cat.fontface=4, category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions"))
venn.plot <- venn.diagram(
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g"),
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
)
venn.plot <- venn.diagram(
x = list(
A = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g"),
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
B = c("b", "c", "d", "e", "g"),
C = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g"),
gene3 = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g"),
gene3 = c("a", "b", "f")
),
euler.d = FALSE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "b", "f")
),
euler.d = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "b", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"), alpha=c(0.5,0.5, 0.5),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"),
alpha=c(0.5,0.5, 0.5),
label.col = c("blue", "green", "purple"),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"),
alpha=c(0.5,0.5, 0.5),
label.col = c("blue", "green", "purple"),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"),
alpha=c(0.5,0.5, 0.5),
#label.col = c("blue", "green", "purple"),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"),
alpha=c(0.5,0.5, 0.5),
#label.col = c("blue", "green", "purple"),
label.col = c("blue"),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"),
alpha=c(0.5,0.5, 0.5),
cat.col = c("blue", "green", "purple"),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
venn.plot <- venn.diagram(
x = list(
gene1 = c("a", "b", "c", "d"),
gene2 = c("b", "c", "d", "e", "g", "h", "i", "j"),
gene3 = c("a", "f")
),
euler.d = TRUE,
scaled = TRUE,
filename = "Euler_3set_scaled.tiff",
cex = 2.5,
cat.cex = 2.5,
cat.pos = 0,
fill=c("white", "white", "white"),
col= c("blue", "green", "purple"),
alpha=c(0.5,0.5, 0.5),
cat.col = c("blue", "green", "purple"),
cat.fontface=4,
ext.text = TRUE,
#category.names=c("ctrl_24h", "ctrl_4d", "24_",
main="Genes with differential splicing between conditions")
source('~/Documents/Masters_Bioinformatics/Internships/Code/co-deletions/Set up R session.R', echo=TRUE)
length(unique(fishers_co_deletion_per_gene_long_table_significanct_p0.05_more_than_20$target_gene))
co_deletions_distance_from_target_gene_plot_table3<- distance_from_target_gene_co_deletion_co_amplification_function(cnv.table = cnv.table, gene_information_list = gene_information_list[1], distance = 2.5e+06, deletion = TRUE, threshold = -2, compare_all_genes = FALSE, normalisation = "tumours.with.event")
cnv.table<-threshold_selected_cnv_list_plus_all_loc$ALL
co_deletions_distance_from_target_gene_plot_table3<- distance_from_target_gene_co_deletion_co_amplification_function(cnv.table = cnv.table, gene_information_list = gene_information_list[1], distance = 2.5e+06, deletion = TRUE, threshold = -2, compare_all_genes = FALSE, normalisation = "tumours.with.event")
co_deletions_distance_from_target_gene_plot_table3<- distance_from_target_gene_co_deletion_co_amplification_function(cnv.table = cnv.table, gene_information_list = gene_information_list[1:2], distance = 2.5e+06, deletion = TRUE, threshold = -2, compare_all_genes = FALSE, normalisation = "tumours.with.event")
