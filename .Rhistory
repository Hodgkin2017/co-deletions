i
i=1
length(immune_cell_infiltrate_annova_per_cancer_list)
column_name<- names(immune_cell_infiltrate_annova_per_cancer_list[i])
column_name
nrow(immune_cell_infiltrate_annova_per_cancer_list[[i]])
for (i in 1: length(immune_cell_infiltrate_annova_per_cancer_list)){
column_name<- names(immune_cell_infiltrate_annova_per_cancer_list[i])
column_name<- rep(column_name, nrow(immune_cell_infiltrate_annova_per_cancer_list[[i]]))
immune_cell_infiltrate_annova_per_cancer_list[[i]]<-cbind(cancer = column_name, immune_cell_infiltrate_annova_per_cancer_list[[i]])
}
head(immune_cell_infiltrate_annova_per_cancer_list[[1]])
immune_cell_infiltrate_annova_per_cancer_list<- readRDS(file = "./R workspaces/immune_cell_infiltrate_annova_per_cancer_list")
head(immune_cell_infiltrate_annova_per_cancer_list[[1]])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
length(immune_cell_infiltrate_annova_per_cancer_list)
names(immune_cell_infiltrate_annova_per_cancer_list)
colnames(immune_cell_infiltrate_annova_per_cancer_list[[1]])
dim(immune_cell_infiltrate_annova_per_cancer_list[[1]])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
sapply(immune_cell_infiltrate_annova_per_cancer_list, function(x) x$cancer[1])
immune_cell_infiltrate_annova_per_cancer_list[[20]] %>%
dplyr::filter(target_gene == "CDKN2A")
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
immune_cell_infiltrate_annova_per_cancer_list[[20]] %>%
dplyr::filter(target_gene == "CDKN2A") %>%
dplyr::select(number_cat1, number_cat2, number_cat3, number_cat4)
immune_cell_infiltrate_annova_per_cancer_list[[20]]$cancer<- rep("ALL", nrow(immune_cell_infiltrate_annova_per_cancer_list[[20]]))
sapply(immune_cell_infiltrate_annova_per_cancer_list, function(x) x$cancer[1])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
immune_cell_infiltrate_annova_per_cancer_table<- do.call(rbind, immune_cell_infiltrate_annova_per_cancer_list[1:19])
dim(immune_cell_infiltrate_annova_per_cancer_list)
dim(immune_cell_infiltrate_annova_per_cancer_table)
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_table$cell_type)
length(immune_cell_types)
immune_cell_types
i
i=1
immune_cell_infiltrate_annova_per_cancer_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
immune_cell_infiltrate_annova_per_cell_type_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_list
for (i in 1: length(immune_cell_types)){
immune_cell_types[[i]]<- immune_cell_infiltrate_annova_per_cancer_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
}
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cell_type_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_list
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- immune_cell_infiltrate_annova_per_cancer_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
i
immune_cell_infiltrate_annova_per_cancer_list<- readRDS(file = "./R workspaces/immune_cell_infiltrate_annova_per_cancer_list")
head(immune_cell_infiltrate_annova_per_cancer_list[[1]])
length(immune_cell_infiltrate_annova_per_cancer_list)
names(immune_cell_infiltrate_annova_per_cancer_list)
colnames(immune_cell_infiltrate_annova_per_cancer_list[[1]])
dim(immune_cell_infiltrate_annova_per_cancer_list[[1]])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
names(immune_cell_infiltrate_annova_per_cancer_list[1])
sapply(immune_cell_infiltrate_annova_per_cancer_list, function(x) x$cancer[1])
immune_cell_infiltrate_annova_per_cancer_list[[20]] %>%
dplyr::filter(target_gene == "CDKN2A") %>%
dplyr::select(number_cat1, number_cat2, number_cat3, number_cat4)
immune_cell_infiltrate_annova_per_cancer_list[[20]]$cancer<- rep("ALL", nrow(immune_cell_infiltrate_annova_per_cancer_list[[20]]))
sapply(immune_cell_infiltrate_annova_per_cancer_list, function(x) x$cancer[1])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
immune_cell_infiltrate_annova_per_cancer_table<- do.call(rbind, immune_cell_infiltrate_annova_per_cancer_list[1:19])
dim(immune_cell_infiltrate_annova_per_cancer_list)
dim(immune_cell_infiltrate_annova_per_cancer_table)
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cell_type_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_list
for (i in 1: length(immune_cell_types)){
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- immune_cell_infiltrate_annova_per_cancer_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
}
i
i=1
immune_table<- immune_cell_infiltrate_annova_per_cell_type_list[[i]]
dim(immune_table)
i
immune_table<- immune_cell_infiltrate_annova_per_cell_type_list[[i]]
dim(immune_table)
immune_table$ANOVA_p_value
immune_table$p_value_cat2_1
immune_table$p_value_cat2_1<=.05
sum(immune_table$p_value_cat2_1<=.05)
sum(immune_table$p_value_cat2_1<=.05, na.rm = TRUE)
i
immune_table<- immune_cell_infiltrate_annova_per_cell_type_list[[i]]
immune_table$BH_adjust_ANOVA<- p.adjust(immune_table$ANOVA_p_value, method = "BH")
immune_table$BH_adjust_cat2_1<- p.adjust(immune_table$p_value_cat2_1, method = "BH")
immune_table$BH_adjust_cat3_1<- p.adjust(immune_table$p_value3_1, method = "BH")
immune_table$BH_adjust_cat4_1<- p.adjust(immune_table$p_value4_1, method = "BH")
immune_table$BH_adjust_cat3_2<- p.adjust(immune_table$p_value3_2, method = "BH")
immune_table$BH_adjust_cat4_2<- p.adjust(immune_table$p_value4_2, method = "BH")
immune_table$BH_adjust_Cat4_3<- p.adjust(immune_table$p_value4_3, method = "BH")
immune_table<- dplyr::arrange(immune_table, BH_adjust_cat2_1)
dim(immune_table)
dim( immune_cell_infiltrate_annova_per_cell_type_list[[i]])
head(immune_table)
sum(immune_table$BH_adjust_cat2_1 <= 0.05, na.rm = TRUE)
for (i in 1: length(immune_cell_infiltrate_annova_per_cell_type_list)){
immune_table<- immune_cell_infiltrate_annova_per_cell_type_list[[i]]
immune_table$BH_adjust_ANOVA<- p.adjust(immune_table$ANOVA_p_value, method = "BH")
immune_table$BH_adjust_cat2_1<- p.adjust(immune_table$p_value_cat2_1, method = "BH")
immune_table$BH_adjust_cat3_1<- p.adjust(immune_table$p_value3_1, method = "BH")
immune_table$BH_adjust_cat4_1<- p.adjust(immune_table$p_value4_1, method = "BH")
immune_table$BH_adjust_cat3_2<- p.adjust(immune_table$p_value3_2, method = "BH")
immune_table$BH_adjust_cat4_2<- p.adjust(immune_table$p_value4_2, method = "BH")
immune_table$BH_adjust_Cat4_3<- p.adjust(immune_table$p_value4_3, method = "BH")
immune_table<- dplyr::arrange(immune_table, BH_adjust_cat2_1)
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- immune_table
}
immune_cell_infiltrate_annova_per_cancer_all_table<- immune_cell_infiltrate_annova_per_cancer_list[[20]]
dim(immune_cell_infiltrate_annova_per_cancer_all_table)
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_all_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cancer_all_table<- immune_cell_infiltrate_annova_per_cancer_list[[20]]
dim(immune_cell_infiltrate_annova_per_cancer_all_table)
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_all_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cell_type_all_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_all_list
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_all_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cell_type_all_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_all_list
for (i in 1: length(immune_cell_types)){
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]<- immune_cell_infiltrate_annova_per_cancer_all_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
}
length(immune_cell_infiltrate_annova_per_cell_type_all_list)
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[1]])
i
i=1
immune_table<- immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]
immune_table$BH_adjust_ANOVA<- p.adjust(immune_table$ANOVA_p_value, method = "BH")
immune_table$BH_adjust_cat2_1<- p.adjust(immune_table$p_value_cat2_1, method = "BH")
immune_table$BH_adjust_cat3_1<- p.adjust(immune_table$p_value3_1, method = "BH")
immune_table$BH_adjust_cat4_1<- p.adjust(immune_table$p_value4_1, method = "BH")
immune_table$BH_adjust_cat3_2<- p.adjust(immune_table$p_value3_2, method = "BH")
immune_table$BH_adjust_cat4_2<- p.adjust(immune_table$p_value4_2, method = "BH")
immune_table$BH_adjust_Cat4_3<- p.adjust(immune_table$p_value4_3, method = "BH")
immune_table<- dplyr::arrange(immune_table, BH_adjust_cat2_1)
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
dim(immune_table)
head(immune_table)
sum(immune_table$BH_adjust_cat2_1 <= 0.05, na.rm = TRUE)
for (i in 1: length(immune_cell_infiltrate_annova_per_cell_type_list)){
immune_table<- immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]
immune_table$BH_adjust_ANOVA<- p.adjust(immune_table$ANOVA_p_value, method = "BH")
immune_table$BH_adjust_cat2_1<- p.adjust(immune_table$p_value_cat2_1, method = "BH")
immune_table$BH_adjust_cat3_1<- p.adjust(immune_table$p_value3_1, method = "BH")
immune_table$BH_adjust_cat4_1<- p.adjust(immune_table$p_value4_1, method = "BH")
immune_table$BH_adjust_cat3_2<- p.adjust(immune_table$p_value3_2, method = "BH")
immune_table$BH_adjust_cat4_2<- p.adjust(immune_table$p_value4_2, method = "BH")
immune_table$BH_adjust_Cat4_3<- p.adjust(immune_table$p_value4_3, method = "BH")
immune_table<- dplyr::arrange(immune_table, BH_adjust_cat2_1)
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]<- immune_table
}
length(immune_cell_infiltrate_annova_per_cell_type_list)
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) x$cell_type)
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) x$cell_type[1])
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) x$cancer[1])
i
i=1
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- rbind(immune_cell_infiltrate_annova_per_cell_type_list[[i]],
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[2]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[3]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- rbind(immune_cell_infiltrate_annova_per_cell_type_list[[i]],
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
unique(immune_cell_infiltrate_annova_per_cell_type_list[[1]]$cancer)
immune_cell_infiltrate_annova_per_cancer_list<- readRDS(file = "./R workspaces/immune_cell_infiltrate_annova_per_cancer_list")
head(immune_cell_infiltrate_annova_per_cancer_list[[1]])
length(immune_cell_infiltrate_annova_per_cancer_list)
names(immune_cell_infiltrate_annova_per_cancer_list)
colnames(immune_cell_infiltrate_annova_per_cancer_list[[1]])
dim(immune_cell_infiltrate_annova_per_cancer_list[[1]])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
names(immune_cell_infiltrate_annova_per_cancer_list[1])
sapply(immune_cell_infiltrate_annova_per_cancer_list, function(x) x$cancer[1])
immune_cell_infiltrate_annova_per_cancer_list[[20]] %>%
dplyr::filter(target_gene == "CDKN2A") %>%
dplyr::select(number_cat1, number_cat2, number_cat3, number_cat4)
immune_cell_infiltrate_annova_per_cancer_list[[20]]$cancer<- rep("ALL", nrow(immune_cell_infiltrate_annova_per_cancer_list[[20]]))
sapply(immune_cell_infiltrate_annova_per_cancer_list, function(x) x$cancer[1])
immune_cell_infiltrate_annova_per_cancer_list[[20]][1:10,]
immune_cell_infiltrate_annova_per_cancer_table<- do.call(rbind, immune_cell_infiltrate_annova_per_cancer_list[1:19])
dim(immune_cell_infiltrate_annova_per_cancer_list)
dim(immune_cell_infiltrate_annova_per_cancer_table)
sapply(immune_cell_infiltrate_annova_per_cancer_table, function(x) x$cancer[1])
unique(immune_cell_infiltrate_annova_per_cancer_table$cancer)
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cell_type_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_list
for (i in 1: length(immune_cell_types)){
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- immune_cell_infiltrate_annova_per_cancer_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
}
for (i in 1: length(immune_cell_infiltrate_annova_per_cell_type_list)){
immune_table<- immune_cell_infiltrate_annova_per_cell_type_list[[i]]
immune_table$BH_adjust_ANOVA<- p.adjust(immune_table$ANOVA_p_value, method = "BH")
immune_table$BH_adjust_cat2_1<- p.adjust(immune_table$p_value_cat2_1, method = "BH")
immune_table$BH_adjust_cat3_1<- p.adjust(immune_table$p_value3_1, method = "BH")
immune_table$BH_adjust_cat4_1<- p.adjust(immune_table$p_value4_1, method = "BH")
immune_table$BH_adjust_cat3_2<- p.adjust(immune_table$p_value3_2, method = "BH")
immune_table$BH_adjust_cat4_2<- p.adjust(immune_table$p_value4_2, method = "BH")
immune_table$BH_adjust_Cat4_3<- p.adjust(immune_table$p_value4_3, method = "BH")
immune_table<- dplyr::arrange(immune_table, BH_adjust_cat2_1)
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- immune_table
}
immune_cell_infiltrate_annova_per_cancer_all_table<- immune_cell_infiltrate_annova_per_cancer_list[[20]]
dim(immune_cell_infiltrate_annova_per_cancer_all_table)
immune_cell_types<- unique(immune_cell_infiltrate_annova_per_cancer_all_table$cell_type)
length(immune_cell_types)
immune_cell_types
immune_cell_infiltrate_annova_per_cell_type_all_list<- vector("list", length(immune_cell_types))
immune_cell_infiltrate_annova_per_cell_type_all_list
for (i in 1: length(immune_cell_types)){
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]<- immune_cell_infiltrate_annova_per_cancer_all_table %>%
dplyr::filter(cell_type == immune_cell_types[i])
}
length(immune_cell_infiltrate_annova_per_cell_type_all_list)
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[1]])
for (i in 1: length(immune_cell_infiltrate_annova_per_cell_type_list)){
immune_table<- immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]
immune_table$BH_adjust_ANOVA<- p.adjust(immune_table$ANOVA_p_value, method = "BH")
immune_table$BH_adjust_cat2_1<- p.adjust(immune_table$p_value_cat2_1, method = "BH")
immune_table$BH_adjust_cat3_1<- p.adjust(immune_table$p_value3_1, method = "BH")
immune_table$BH_adjust_cat4_1<- p.adjust(immune_table$p_value4_1, method = "BH")
immune_table$BH_adjust_cat3_2<- p.adjust(immune_table$p_value3_2, method = "BH")
immune_table$BH_adjust_cat4_2<- p.adjust(immune_table$p_value4_2, method = "BH")
immune_table$BH_adjust_Cat4_3<- p.adjust(immune_table$p_value4_3, method = "BH")
immune_table<- dplyr::arrange(immune_table, BH_adjust_cat2_1)
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]]<- immune_table
}
unique(immune_cell_infiltrate_annova_per_cell_type_list[[1]]$cancer)
dim(immune_cell_infiltrate_annova_per_cell_type_list[[1]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[1]])
i
i=1
testrbind<- (immune_cell_infiltrate_annova_per_cell_type_list[[i]],
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
test<- rbind(immune_cell_infiltrate_annova_per_cell_type_list[[i]],
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
dim(test)
unique(immune_cell_infiltrate_annova_per_cell_type_list[[1]]$cancer)
dim(immune_cell_infiltrate_annova_per_cell_type_list[[1]])
dim(immune_cell_infiltrate_annova_per_cell_type_all_list[[1]])
for (i in 1: length(immune_cell_infiltrate_annova_per_cell_type_list)) {
immune_cell_infiltrate_annova_per_cell_type_list[[i]]<- rbind(immune_cell_infiltrate_annova_per_cell_type_list[[i]],
immune_cell_infiltrate_annova_per_cell_type_all_list[[i]])
}
dim(immune_cell_infiltrate_annova_per_cell_type_list[[1]])
unique(immune_cell_infiltrate_annova_per_cell_type_list[[1]]$cancer)
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) x$cell_type[1])
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) unique(x$cell_type))
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) x$cancer[1])
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) unique(x$cancer))
lapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) unique(x$cancer))
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) unique(x$cell_type))
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) unique(x$cell_type))
colnames(immune_cell_infiltrate_annova_per_cell_type_list[[1]])
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) sum(x$BH_adjust_cat2_1 <= 0.05))
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) sum(x$BH_adjust_cat2_1 <= 0.05, na.rm = TRUE))
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) sum(x$BH_adjust_cat2_1 <= 0.1, na.rm = TRUE))
Resting_Natural_killer_cell_p0_05<-immune_cell_infiltrate_annova_per_cell_type_list[[12]]
Resting_Natural_killer_cell_p0_05<- Resting_Natural_killer_cell_p0_05 %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.1) %>%
dplyr::arrange(BH_adjust_cat2_1)
head(Resting_Natural_killer_cell_p0_05)
dim(Resting_Natural_killer_cell_p0_05)
Resting_Natural_killer_cell_p0_1<-immune_cell_infiltrate_annova_per_cell_type_list[[12]]
Resting_Natural_killer_cell_p0_1<- Resting_Natural_killer_cell_p0_1 %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.1) %>%
dplyr::arrange(BH_adjust_cat2_1)
head(Resting_Natural_killer_cell_p0_1)
dim(Resting_Natural_killer_cell_p0_1)
Resting_Natural_killer_cell_p0_1_more_than_20<- Resting_Natural_killer_cell_p0_1 %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20)
dim(Resting_Natural_killer_cell_p0_1_more_than_20)
head(Resting_Natural_killer_cell_p0_1_more_than_20)
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
dplyr::filter(filter1 <= p_value) %>%
dplyr::arrange(filter1)
p_value = 0.05
filter1 = "BH_adjust_cat2_1"
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
dplyr::filter(filter1 <= p_value) %>%
dplyr::arrange(filter1)
dim(output_table)
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) sum(x$BH_adjust_cat2_1 <= 0.05, na.rm = TRUE))
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
filter1 = "BH_adjust_cat2_1"
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
dplyr::filter(filter1 <= p_value) %>%
dplyr::arrange(filter1)
dim(output_table)
output_table<- input_table %>%
dplyr::filter(filter1 <= 0.05) %>%
dplyr::arrange(filter1)
dim(output_table)
output_table<- input_table %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.05) %>%
dplyr::arrange(filter1)
output_table<- input_table %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.05) %>%
dplyr::arrange(filter1)
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
filter1 = "BH_adjust_cat2_1"
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.05) %>%
dplyr::arrange(filter1)
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
filter1 = "BH_adjust_cat2_1"
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.05) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
output_table<- input_table %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
output_table<- input_table %>%
dplyr::filter(filter1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
output_table<- input_table %>%
dplyr::filter(paste(filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
paste(filter1)
output_table<- input_table %>%
dplyr::filter(UQ(filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
output_table<- input_table %>%
dplyr::filter(!!(filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
output_table<- input_table %>%
dplyr::filter(!!(filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
(!!(filter1)
)
output_table<- input_table %>%
dplyr::filter((!!filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
?enquo
as.name(filter1)
output_table<- input_table %>%
dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
output_table<- input_table %>%
dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(filter1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
filter1 = "BH_adjust_cat2_1"
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(filter1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
filter1 = "BH_adjust_cat2_1"
select1 = "number_cat1"
select2 = "number_cat2"
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
dim(output_table)
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1) %>%
dplyr::filter(dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20))
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::filter(dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20))
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::filter(dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20))
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
input_table = immune_cell_infiltrate_annova_per_cell_type_list[[1]]
p_value = 0.05
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
output_table<- output_table %>%
dplyr::filter(dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20))
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
output_table
Resting_Natural_killer_cell_p0_1<-immune_cell_infiltrate_annova_per_cell_type_list[[12]]
Resting_Natural_killer_cell_p0_1<- Resting_Natural_killer_cell_p0_1 %>%
dplyr::filter(BH_adjust_cat2_1 <= 0.1) %>%
dplyr::arrange(BH_adjust_cat2_1)
head(Resting_Natural_killer_cell_p0_1)
dim(Resting_Natural_killer_cell_p0_1)
Resting_Natural_killer_cell_p0_1_more_than_20<- Resting_Natural_killer_cell_p0_1 %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20)
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::arrange(BH_adjust_cat2_1)
output_table<- output_table %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20)
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20) %>%
dplyr::arrange(BH_adjust_cat2_1)
significant_selection<- function(input_table, p_value){
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20) %>%
dplyr::arrange(BH_adjust_cat2_1)
}
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) significant_selection(x, 0.05))
lapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) significant_selection(x, 0.05))
significant_selection<- function(input_table, p_value){
output_table<- input_table %>%
#dplyr::filter(as.name(filter1) <= p_value) %>%
dplyr::filter(BH_adjust_cat2_1 <= p_value) %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20) %>%
dplyr::arrange(BH_adjust_cat2_1)
}
immune_cell_infiltrate_annova_per_cell_type_significant_list<- lapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) significant_selection(x, 0.05))
sapply(immune_cell_infiltrate_annova_per_cell_type_significant_list, function(x) nrow(x))
sapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x) unique(x$cell_type))
colnames(immune_cell_infiltrate_annova_per_cell_type_list[[19]])
immune_cell_infiltrate_annova_per_cell_type_list[[19]] %>%
dplyr::filter(target_gene == "CDKN2A")
colnames(immune_cell_infiltrate_annova_per_cell_type_list[[19]])
immune_cell_infiltrate_annova_per_cell_type_list[[19]] %>%
dplyr::filter(target_gene == "CDKN2A") %>%
dplyr::filter(p_value_cat2_1 <= 0.05)
immune_cell_infiltrate_annova_per_cell_type_list[[19]] %>%
dplyr::filter(target_gene == "CDKN2A") %>%
dplyr::filter(p_value_cat2_1 <= 0.05) %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20)
significant_gene_selection<- function(x, gene){
x %>%
dplyr::filter(target_gene == gene) %>%
dplyr::filter(p_value_cat2_1 <= 0.05) %>%
dplyr::filter(number_cat1 >= 20 & number_cat2 >= 20)
}
lapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x)significant_gene_selection(x, "CDKN2A"))
CDKN2A_significant_immune_infiltration<- lapply(immune_cell_infiltrate_annova_per_cell_type_list, function(x)significant_gene_selection(x, "CDKN2A"))
immune_cell_types
names(CDKN2A_significant_immune_infiltration)<- immune_cell_types
sapply(CDKN2A_significant_immune_infiltration, function(x) nrow(x))
CDKN2A_significant_immune_infiltration$`Activated Natural killer cell`
CDKN2A_significant_immune_infiltration$`Resting Natural killer cell`
CDKN2A_significant_immune_infiltration$`CD8 T cell`
?ver
R.version
R.version()
